var daysInWeek = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
var daysInWeekShort = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
var shortMonthsInYear = ["","Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
var longMonthsInYear = ["","January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
var dateEnd = ['st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'st', 'nd', 'rd', 'th', 'th', 'th', 'th', 'th', 'th', 'th', 'th'];

function format(date, dateFormat) {
  if (typeof date === "number") {
    return format(new Date(date), dateFormat);
  }
  dateFormat += ' ';
  var month = date.getMonth() + 1;
  var pattern = "";
  var retValue = "";
  for (var i = 0; i < dateFormat.length - 1; i++) {
    var chr = dateFormat.charAt(i);
    pattern += chr;
    if (chr === dateFormat.charAt(i + 1)) {
      continue;
    }
    switch (pattern) {
      case "dd":
        retValue += date.getDate().toString().padStart(2, '0');
        break;
      case "d":
        retValue += date.getDate();
        break;
      case "www":
      case "wwww":
        retValue += daysInWeek[date.getDay()];
        break;
      case "ww":
        retValue += daysInWeekShort[date.getDay()];
        break;
      case "w":
        retValue += date.getDay();
        break;
      case "D":
        retValue += date.getDate() + dateEnd[date.getDate()];
        break;
      case "MMMM":
        retValue += longMonthsInYear[month];
        break;
      case "MMM":
        retValue += shortMonthsInYear[month];
        break;
      case "MM":
        retValue += month.toString().padStart(2, '0');
        break;
      case "M":
        retValue += month;
        break;
      case "yy":
        retValue += date.getFullYear().toString().slice(-2);
        break;
      case "yyyy":
        retValue += date.getFullYear();
        break;
      case "HH":
        retValue += date.getHours().toString().padStart(2, '0');
        break;
      case "H":
        retValue += date.getHours();
        break;
      case "hh":
        var hour = date.getHours() % 12;
        retValue += (hour === 0 ? 12 : hour).toString().padStart(2, '0');
        break;
      case "h":
        var hour = date.getHours() % 12;
        retValue += (hour === 0 ? 12 : hour);
        break;
      case "mm":
        retValue += date.getMinutes().toString().padStart(2, '0');
        break;
      case "m":
        retValue += date.getMinutes();
        break;
      case "ss":
        retValue += date.getSeconds().toString().padStart(2, '0');
        break;
      case "s":
        retValue += date.getSeconds();
        break;
      case "S":
      case "SS":
      case "SSS":
        retValue += date.getMilliseconds().toString().padStart(3, '0');
        break;
      case "a":
        retValue += date.getHours() >= 12 ? "PM" : "AM";
        break;
      case "p":
        retValue += date.getHours() >= 12 ? "p.m." : "a.m.";
        break;
       case "\\":
        retValue += dateFormat.charAt(++i);
        break;
      default:
        retValue += chr;
        break;
    }
    pattern = "";
  }
  return retValue;

}

exports.format = format;
  